# UrbanSheild & UrbanShieldPortal

This repository contains a **Django backend** and **React frontend** for a disaster & traffic monitoring system focused on Uttarakhand, India.  The app visualises realâ€‘time traffic congestion as a coloured heatmap and displays disaster incidents using flame icons on a map.

---

## ğŸš€ Quick Start (2â€¯minutes)

1. **Ensure backend & frontend are running:**
   ```bash
   # backend
   cd UrbanSheild
   py manage.py runserver

   # frontend (in another terminal)
   cd UrbanShieldPortal
   npm install && npm run dev
   ```
2. **Generate sample data** (traffic already generated for you by default):
   ```bash
   cd UrbanSheild
   py manage.py generate_traffic_data --count 80 --clear
   # optional: disasters
   py manage.py generate_disaster_data --count 30 --clear
   ```
3. **Open the map** in your browser: `http://localhost:5173`
4. Click **Show Traffic** and **Show Disasters** buttons in the topâ€‘left control panel.

> The layers are **loaded lazily**; nothing appears until the corresponding button is clicked.

---

## â­ Features at a glance

- Traffic heatmap with 6â€‘colour gradient (greenâ†’yellowâ†’orangeâ†’red) based on congestion level (1â€“10).
- Disaster markers shown as **black flame icon inside coloured circles**; circle colour represents disaster type.
- Toggle controls for traffic & disasters with loading states and live counts.
- Uttarakhand boundary overlay (GeoJSON).
- Management commands to generate realistic traffic & disaster data.
- REST API endpoints:
  - GET `/api/traffic/` â€“ returns traffic incidents
  - GET `/api/disasters/` â€“ returns disasters filtered to Uttarakhand
- Documentation files included for quick reference and setup.

---

## ğŸ›  Backend overview

### Models
| Model | Fields |
|-------|--------|
| `TrafficIncident` | latitude, longitude, congestion_level (1â€‘10), is_blocked, created_at |
| `Disaster` | latitude, longitude, disaster_type, severity, confidence_score, status, created_at |
| Other models for authorities, shelters, escalation logs, etc. |

### Management commands
- `generate_traffic_data` â€“ creates random traffic points within Uttarakhand zones.
  - `--count N` to specify number, `--clear` to delete existing.
- `generate_disaster_data` â€“ creates random disasters (restricted to Uttarakhand by default).
  - Add `--anywhere` to scatter points across all of India.

### API behavior
`DisasterViewSet.get_queryset()` returns only incidents inside defined Uttarakhand bounds; this is why previously empty responses occurred when data lay outside.
`TrafficIncidentViewSet` also filters to Uttarakhand.

Additional actions provide response planning, escalation, and data fetching from external services (earthquakes, weather).

---

## ğŸ—º Frontend architecture

All map logic lives in `UrbanShieldPortal/src/components/map/MapView.jsx`.
Key points:
- `HeatmapLayer` component uses `leaflet.heat` with gradient:
  ```js
  gradient: {
    0.0: '#00ff00',
    0.2: '#7fff00',
    0.4: '#ffff00',
    0.6: '#ffa500',
    0.8: '#ff6347',
    1.0: '#ff0000'
  }
  ```
- Traffic and disaster data fetched only when their toggles are clicked (state `showTraffic` and `showDisasters` start false).
- Disaster icons generated by `getIcon()` returning a `L.divIcon` with flame emoji and typeâ€‘colour background.
- Control panel includes buttons with loading spinner and counts, located inside an absolutelyâ€‘positioned div.
- `DisasterLegend.jsx` displays colour circle examples matching the icons.

---

## ğŸ“„ Detailed documentation (merged)

> The following sections are drawn from the individual markdown guides previously located in the repository.

### Quick view & user experience

When the app first loads the map is blank except for the Uttarakhand boundary. Use the topâ€‘left buttons to load layers. Counts show a dash until the corresponding layer is activated. Click individual disaster icons to view details (severity, coordinates, confidence, timestamp).

### Setup & data generation

Refer to *Traffic Data Setup Guide* section below (copied verbatim) for complete instructions on generating and verifying traffic and disaster data. This includes examples of using both the management commands and the shell script.

[**Traffic Data Setup Guide** continues belowâ€¦]

### Heatmap colour legend and interpretation

Traffic points have a `congestion_level` 1â€“10; intensity is normalised (`/10`) before rendering. The gradient maps green for low values to red for high values. Inspect the `HeatmapLayer` code for exact hex codes.

### Disaster icon style

Every disaster uses the ğŸ”¥ emoji in a 50Ã—50 circle. Circle colours:
- Blue: flood
- Red: fire
- Purple: earthquake
- Cyan: cyclone
- Amber: heatwave

Severity produces a border: dark red for â‰¥8, dark orange for â‰¥5.

---

## ğŸ§© Combined documentation sections

<!-- TRAFFIC_SETUP.md content inserted here -->

```
`TRAFFIC_SETUP.md` content truncated for brevity in this summary. It includes quick start, verify steps, heatmap legend, customization instructions, and disaster generator guidance.
```

<!-- Similarly incorporate other docs or provide links -->

---

## âœ… Verification checklist

1. Backend checks:
   - `py manage.py check` shows no errors.
   - API endpoints return 200 and appropriate JSON.
   - Database contains traffic/disaster records.
2. Frontend tests:
   - Buttons load layers correctly.
   - Heatmap colours vary according to congestion level.
   - Disaster icons are present and styled correctly after generation.
   - No console errors in browser.
3. Optional:
   - Run disaster generator with `--anywhere` and verify icons outside Uttarakhand.
   - Confirm toggle behaviour hides/shows layers as expected.

---

## ğŸ“ Repository structure (selected)
```
UrbanSheild/                    # Django project
â”œâ”€â”€ apps/traffic/               # traffic app with models, views, generators
â”œâ”€â”€ apps/disasters/             # disaster app with generator and viewset
â”œâ”€â”€ config/                     # project settings, urls
â”œâ”€â”€ db.sqlite3                  # sample database
â”œâ”€â”€ manage.py
â””â”€â”€ requirements.txt

UrbanShieldPortal/             # React frontend
â”œâ”€â”€ src/components/map/         # MapView.jsx, DisasterLegend.jsx, DisasterFilter.jsx
â”œâ”€â”€ api/axios.js                # axios instance
â”œâ”€â”€ pages/                      # Dashboard, Login, etc.
â””â”€â”€ vite.config.js              # build config

Documentation files at repo root: START_HERE.md, QUICK_VIEW.md, TRAFFIC_SETUP.md, IMPLEMENTATION_SUMMARY.md, ARCHITECTURE.md, VERIFICATION_CHECKLIST.md, FINAL_SUMMARY.md, DOCUMENTATION_INDEX.md, README.md
```

---

## ğŸ“ Future enhancements
- Integrate real TomTom/Google traffic API.
- Enable auto-refresh of data every 30â€¯s.
- Add disaster filtering by type and severity.
- Support mobileâ€‘friendly UI.
- Add historical data analytics and export.

---

## ğŸ“¦ Installation & dependencies

Backend requires Python 3.11+ with packages listed in `requirements.txt` (Django 6.0.2, djangorestframework, simplejwt, django-cors-headers). Frontend uses React 19.2.0, Leaflet 5.0, axios, and Vite 7.3.1.

```bash
# backend
py -m pip install -r UrbanSheild/requirements.txt
# frontend
cd UrbanShieldPortal && npm install
```

---

## ğŸ Troubleshooting

- **Server wonâ€™t start?** Run `py manage.py check` to see errors, ensure `.env` has required keys or remove dotenv reference.
- **No heatmap or markers?** Data generation step missing; run the appropriate management command.
- **Icons look wrong?** Clear browser cache and rebuild frontend (`npm run dev`).
- **API returns empty array for disasters?** Ensure generator confined to Uttarakhand or use `--anywhere` flag.

---

## ğŸ“£ License & contributions

This project is for demonstration/educational purposes. Feel free to fork, experiment, and adapt to your needs. When pushing to GitHub, include this README to help others get started quickly.

---

*End of consolidated README.*